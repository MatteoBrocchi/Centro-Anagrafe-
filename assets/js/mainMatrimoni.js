$(function(){var n,e,o,i,t=1,a=new Array,r=new Array,c=new Array,l=!1,s=!1,d=!1,p=!1,m=!1,u=!1;function g(e){$(".pagination").empty(),n=e.length%$("#shownumber").val()==0?parseInt(e.length/$("#shownumber").val()):parseInt(e.length/$("#shownumber").val()+1),$(".pagination").append('<li class="page-item" id="previous"> <a class="page-link" href="#main" tabindex="-1"  style="text-decoration:none"aria-disabled="true">Precedente</a> </li>');for(let e=0;e<n;e++)$(".pagination").append('<li class="page-item numeri"><a class="page-link" style="text-decoration:none" href="#main">'+(e+1)+"</a></li>");$(".pagination").append('<li class="page-item" id="next"> <a class="page-link" href="#main" style="text-decoration:none"tabindex="-1" aria-disabled="true">Successivo</a> </li>'),v(1,$("#shownumber").val(),e)}function h(){$("#persone").empty()}function v(n,e,o){let i=0;h(),i=o.length<e*n?o.length:e*n;for(let t=n*e-e;t<i;t++){let n=o[t].anno_nascita.split("-")[2]+"-"+o[t].anno_nascita.split("-")[1]+"-"+o[t].anno_nascita.split("-")[0];$("#persone").append("<tr><td>"+o[t].nome+"</td><td>"+o[t].cognome+"</td><td>"+o[t].matrimoni[0].nome_coniuge+"</td><td>"+o[t].matrimoni[0].cognome_coniuge+"</td><td>"+n+"</td><td>"+o[t].matrimoni[0].comune+'<td class="d-flex justify-content-center bottoni"><a href="indexMatrimonioPersona.html"><i class="fas fa-church wedding rounded" title="Matrimoni personali" id="'+o[t].id+'"></i></a></td></tr>')}}function f(n,e){let o=0;return n>e?o=1:n<e&&(o=-1),o}$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche",dataType:"json",success:function(n){$.each(n,function(n,e){0!=e.matrimoni.length&&null==e.data_morte&&a.push(Object.assign({},e))}),g(a),document.getElementById("loading_screen").style.display="none"}}),$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/territorio",dataType:"json",success:function(n){$.each(n,function(n,e){c.push(Object.assign({},e)),c=c[0];for(let n=0;n<20;n++){$(".regioni").append(new Option(c[n].nome,c[n].nome));for(let e=0;e<c[n].province.length;e++){$(".province").append(new Option(c[n].province[e].nome));for(let o=0;o<c[n].province[e].comuni.length;o++)$(".comuni").append(new Option(c[n].province[e].comuni[o])),$("#birthPlace").append(new Option(c[n].province[e].comuni[o]))}}})}}),$(document).on("change",".regioni",function(){$(".province").empty(),$(".comuni").empty(),$(".province").append(new Option("Seleziona provincia")),$(".comuni").append(new Option("Seleziona comune"));for(var n=$(".regioni").val(),e=0;e<20;e++)if(c[e].nome==n)for(let n=0;n<c[e].province.length;n++){$(".province").append(new Option(c[e].province[n].nome,c[e].province[n].nome));for(let o=0;o<c[e].province[n].comuni.length;o++)$(".comuni").append(new Option(c[e].province[n].comuni[o],c[e].province[n].comuni[o]))}}),$(document).on("click"),$(document).on("change",".province",function(){$(".comuni").empty(),$(".comuni").append(new Option("Seleziona comune"));for(var n=$(".province").val(),e=0;e<20;e++)for(var o=0;o<c[e].province.length;o++)if(c[e].province[o].nome==n){$(".regioni").val(c[e].nome);for(var i=0;i<c[e].province[o].comuni.length;i++)$(".comuni").append(new Option(c[e].province[o].comuni[i],c[e].province[o].comuni[i]))}}),$(document).on("change",".comuni",function(){for(var n=$(".comuni").val(),e=0;e<20;e++)for(var o=0;o<c[e].province.length;o++)for(var i=0;i<c[e].province[o].comuni.length;i++)c[e].province[o].comuni[i]==n&&($(".regioni").val(c[e].nome),$(".province").val(c[e].province[o].nome),$(".comuni").val(n))}),$(document).on("keyup","#search",function(){r.length=0,h();var n=0,e=$(this).val();e?(e=e.toLowerCase(),$.each(a,function(o,i){i.luoghi_residenza.length;-1!=i.codice.toLowerCase().indexOf(e)&&(r[n]=i,n++)}),g(r)):g(a)}),$("#shownumber").change(function(){g(a)}),$(document).on("click",".edit",function(){e=$(this).attr("id");for(let o=0;o<a.length;o++)if(a[o].id==e){var n=a[o];break}$("#nomemod").val(n.nome),$("#cognomemod").val(n.cognome);let o=n.luoghi_residenza.length;$("#comunemod").val(n.luoghi_residenza[o-1].comune),$("#provinciamod").val(n.luoghi_residenza[o-1].provincia),$("#regionemod").val(n.luoghi_residenza[o-1].regione),$("#annomod").val(n.anno_nascita),$("#viamod").val(n.luoghi_residenza[o-1].indirizzo)}),$(document).on("click",".inviaModifica",function(){dt='{"regione":"'+$("#regionemod").val().toString()+'","provincia":"'+$("#provinciamod").val().toString()+'","comune":"'+$("#comunemod").val().toString()+'","indirizzo":"'+$("#viamod").val().toString()+'"}',$.ajax({type:"POST",headers:{"Access-Control-Allow-Origin":"*"},data:dt,contentType:"application/json",crossDomain:!0,url:"https://late-frost-5190.getsandbox.com/anagrafiche/edit/"+e+"/residenza/",dataType:"json",success:function(n){}}),dt='{"nome":"'+$("#nomemod").val().toString()+'","cognome":"'+$("#cognomemod").val().toString()+'","anno_nascita":"'+$("#annomod").val().toString()+'","anno_residenza":"2020"}',$.ajax({type:"POST",headers:{"Access-Control-Allow-Origin":"*"},data:dt,contentType:"application/json",crossDomain:!0,url:"https://late-frost-5190.getsandbox.com/anagrafiche/edit/"+e+"/",dataType:"json",success:function(n){}}),$("#exampleModalEdit").modal("toggle"),document.getElementById("loading_screen").style.display="block",h(),a=[],$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche",dataType:"json",success:function(n){$.each(n,function(n,e){a.push(Object.assign({},e)),document.getElementById("loading_screen").style.display="none"}),g(a)}})}),$(document).on("click",".delete",function(){o=$(this).attr("id")}),$(document).on("click",".btnElimina",function(){$.ajax({type:"DELETE",headers:{"Access-Control-Allow-Origin":"*"},contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche/remove/"+o+"/",dataType:"json"}).then(function(n){$(".bottoni .delete").each(function(){$(this).attr("id")==o&&$(this).parent().parent().remove()})},function(n,e,o){alert(n.responseText)})}),$(document).on("click",".wedding",function(){localStorage.setItem("idprova",$(this).attr("id"))}),$(document).on("click",".order",function(){var n=new Array;switch($(this).attr("id")){case"nome":for(let e=0;e<a.length;e++){for(let o=e+1;o<a.length;o++)l?f(a[o].nome,a[e].nome)>0&&(n=a[o],a[o]=a[e],a[e]=n):f(a[o].nome,a[e].nome)<0&&(n=a[e],a[e]=a[o],a[o]=n);g(a)}l=!l;break;case"cognome":for(let e=0;e<a.length;e++){for(let o=e+1;o<a.length;o++)s?f(a[o].cognome,a[e].cognome)>0&&(n=a[o],a[o]=a[e],a[e]=n):f(a[o].cognome,a[e].cognome)<0&&(n=a[e],a[e]=a[o],a[o]=n);g(a)}s=!s;break;case"regione":for(let i=0;i<a.length;i++){for(let t=i+1;t<a.length;t++){var e=a[t].luoghi_residenza.length,o=a[i].luoghi_residenza.length;d?f(a[t].luoghi_residenza[e-1].regione,a[i].luoghi_residenza[o-1].regione)>0&&(n=a[t],a[t]=a[i],a[i]=n):f(a[t].luoghi_residenza[e-1].regione,a[i].luoghi_residenza[o-1].regione)<0&&(n=a[i],a[i]=a[t],a[t]=n)}g(a)}d=!d;break;case"provincia":for(let i=0;i<a.length;i++){for(let t=i+1;t<a.length;t++){e=a[t].luoghi_residenza.length,o=a[i].luoghi_residenza.length;p?f(a[t].luoghi_residenza[e-1].provincia,a[i].luoghi_residenza[o-1].provincia)>0&&(n=a[t],a[t]=a[i],a[i]=n):f(a[t].luoghi_residenza[e-1].provincia,a[i].luoghi_residenza[o-1].provincia)<0&&(n=a[i],a[i]=a[t],a[t]=n)}g(a)}p=!p;break;case"comune":for(let i=0;i<a.length;i++){for(let t=i+1;t<a.length;t++){e=a[t].luoghi_residenza.length,o=a[i].luoghi_residenza.length;m?f(a[t].luoghi_residenza[e-1].comune,a[i].luoghi_residenza[o-1].comune)>0&&(n=a[t],a[t]=a[i],a[i]=n):f(a[t].luoghi_residenza[e-1].comune,a[i].luoghi_residenza[o-1].comune)<0&&(n=a[i],a[i]=a[t],a[t]=n)}g(a)}m=!m;break;case"anno":for(let e=0;e<a.length;e++){for(let o=e+1;o<a.length;o++)u?f(a[o].anno_nascita,a[e].anno_nascita)>0&&(n=a[o],a[o]=a[e],a[e]=n):f(a[o].anno_nascita,a[e].anno_nascita)<0&&(n=a[e],a[e]=a[o],a[o]=n);g(a)}u=!u}}),$(document).on("click","#previous",function(){1==t&&t++,v(--t,$("#shownumber").val(),a)}),$(document).on("click","#next",function(){t==n&&t--,v(++t,$("#shownumber").val(),a)}),$(document).on("click",".numeri>.page-link",function(){var n=$(this).text();t=n,v(n,$("#shownumber").val(),a)}),i=!1,$(window).scroll(function(){$(this).scrollTop()>100?(i||($("#nav>ul").prepend("<li class='titolo'>Ufficio Anagrafe</li>"),i=!0),$("#nav").addClass("shrink")):(i&&($("#nav>ul").find(":first").remove(),i=!1),$("#nav").removeClass("shrink"))});var y=$(window),_=$("body");breakpoints({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:[null,"736px"]}),y.on("load",function(){window.setTimeout(function(){_.removeClass("is-preload")},100)}),$("#nav > ul").dropotron({mode:"fade",noOpenerFade:!0,alignment:"center"}),$('<div id="titleBar"><a href="#navPanel" class="toggle"></a></div>').appendTo(_),$('<div id="navPanel"><nav>'+$("#nav").navList()+"</nav></div>").appendTo(_).panel({delay:500,hideOnClick:!0,hideOnSwipe:!0,resetScroll:!0,resetForms:!0,side:"left",target:_,visibleClass:"navPanel-visible"})});
