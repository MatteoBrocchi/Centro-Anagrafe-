$(function(){var e,n,o,i,t=1,a=new Array,r=new Array,c=new Array,l=(localStorage.getItem("idprova"),!1),d=!1,s=!1,p=!1,g=!1,u=!1;function m(n){$(".pagination").empty(),e=n.luoghi_residenza.length%$("#shownumber").val()==0?parseInt(n.luoghi_residenza.length/$("#shownumber").val()):parseInt(n.luoghi_residenza.length/$("#shownumber").val()+1),$(".pagination").append('<li class="page-item" id="previous"> <a class="page-link" href="#main" tabindex="-1"  style="text-decoration:none"aria-disabled="true">Precedente</a> </li>');for(let n=0;n<e;n++)$(".pagination").append('<li class="page-item numeri"><a class="page-link" style="text-decoration:none" href="#main">'+(n+1)+"</a></li>");$(".pagination").append('<li class="page-item" id="next"> <a class="page-link" href="#main" style="text-decoration:none"tabindex="-1" aria-disabled="true">Successivo</a> </li>'),h(1,$("#shownumber").val(),n)}function v(){$("#persone").empty()}function h(e,n,o){let i=0;$("#nomePersonaSelezionata").text(o.nome+" "+o.cognome),v(),i=o.luoghi_residenza.length<n*e?o.luoghi_residenza.length:n*e;for(let t=e*n-n;t<i;t++){let e=o.luoghi_residenza[t].anno.split("-")[2]+"-"+o.luoghi_residenza[t].anno.split("-")[1]+"-"+o.luoghi_residenza[t].anno.split("-")[0];$("#persone").append("<tr><td>"+o.luoghi_residenza[t].regione+"</td><td>"+o.luoghi_residenza[t].provincia+"</td><td>"+o.luoghi_residenza[t].comune+"</td><td>"+o.luoghi_residenza[t].indirizzo+"</td><td>"+e+'</td><td class="d-flex justify-content-center bottoni"><i class="fas fa-trash-alt delete rounded" title="Elimina" id="'+(t+1)+'" data-toggle="modal" data-target="#modalEliminaRes"></i><i class="fas fa-edit edit rounded" title="Modifica" id="'+(t+1)+'" data-toggle="modal" data-target="#exampleModalEdit"></i></td></tr>')}}function f(e,n){let o=0;return e>n?o=1:e<n&&(o=-1),o}$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche",dataType:"json",success:function(e){$.each(e,function(e,n){a.push(Object.assign({},n))});for(let e=0;e<a.length;e++)a[e].id==localStorage.getItem("idprova")&&(e=(a=a[e]).length);a.id==localStorage.getItem("idprova")&&null!=a.data_morte&&($("#aggiungiResidenza").hide(),$("#aggiungiResidenza").attr("data-target","")),m(a),document.getElementById("loading_screen").style.display="none"}}),$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/territorio",dataType:"json",success:function(e){$.each(e,function(e,n){c.push(Object.assign({},n)),c=c[0];for(let e=0;e<20;e++){$(".regioni").append(new Option(c[e].nome,c[e].nome)),$(".regioniEdit").append(new Option(c[e].nome,c[e].nome));for(let n=0;n<c[e].province.length;n++){$(".province").append(new Option(c[e].province[n].nome)),$(".provinceEdit").append(new Option(c[e].province[n].nome));for(let o=0;o<c[e].province[n].comuni.length;o++)$(".comuni").append(new Option(c[e].province[n].comuni[o])),$(".comuniEdit").append(new Option(c[e].province[n].comuni[o])),$("#birthPlace").append(new Option(c[e].province[n].comuni[o]))}}})}}),$(document).on("change",".regioni",function(){$(".province").empty(),$(".comuni").empty(),$(".province").append(new Option("Seleziona provincia")),$(".comuni").append(new Option("Seleziona comune"));for(var e=$(".regioni").val(),n=0;n<20;n++)if(c[n].nome==e)for(let e=0;e<c[n].province.length;e++){$(".province").append(new Option(c[n].province[e].nome,c[n].province[e].nome));for(let o=0;o<c[n].province[e].comuni.length;o++)$(".comuni").append(new Option(c[n].province[e].comuni[o],c[n].province[e].comuni[o]))}}),$(document).on("click"),$(document).on("change",".province",function(){$(".comuni").empty(),$(".comuni").append(new Option("Seleziona comune"));for(var e=$(".province").val(),n=0;n<20;n++)for(var o=0;o<c[n].province.length;o++)if(c[n].province[o].nome==e){$(".regioni").val(c[n].nome);for(var i=0;i<c[n].province[o].comuni.length;i++)$(".comuni").append(new Option(c[n].province[o].comuni[i],c[n].province[o].comuni[i]))}}),$(document).on("change",".comuni",function(){for(var e=$(".comuni").val(),n=0;n<20;n++)for(var o=0;o<c[n].province.length;o++)for(var i=0;i<c[n].province[o].comuni.length;i++)c[n].province[o].comuni[i]==e&&($(".regioni").val(c[n].nome),$(".province").val(c[n].province[o].nome),$(".comuni").val(e))}),$(document).on("change",".regioniEdit",function(){$(".provinceEdit").empty(),$(".comuniEdit").empty(),$(".provinceEdit").append(new Option("Seleziona provincia")),$(".comuniEdit").append(new Option("Seleziona comune"));for(var e=$(".regioniEdit").val(),n=0;n<20;n++)if(c[n].nome==e)for(let e=0;e<c[n].province.length;e++){$(".provinceEdit").append(new Option(c[n].province[e].nome,c[n].province[e].nome));for(let o=0;o<c[n].province[e].comuni.length;o++)$(".comuniEdit").append(new Option(c[n].province[e].comuni[o],c[n].province[e].comuni[o]))}}),$(document).on("click"),$(document).on("change",".provinceEdit",function(){$(".comuniEdit").empty(),$(".comuniEdit").append(new Option("Seleziona comune"));for(var e=$(".provinceEdit").val(),n=0;n<20;n++)for(var o=0;o<c[n].province.length;o++)if(c[n].province[o].nome==e){$(".regioniEdit").val(c[n].nome);for(var i=0;i<c[n].province[o].comuni.length;i++)$(".comuniEdit").append(new Option(c[n].province[o].comuni[i],c[n].province[o].comuni[i]))}}),$(document).on("change",".comuniEdit",function(){for(var e=$(".comuniEdit").val(),n=0;n<20;n++)for(var o=0;o<c[n].province.length;o++)for(var i=0;i<c[n].province[o].comuni.length;i++)c[n].province[o].comuni[i]==e&&($(".regioniEdit").val(c[n].nome),$(".provinceEdit").val(c[n].province[o].nome),$(".comuniEdit").val(e))}),$(document).on("keyup","#search",function(){r.length=0,v();var e=0,n=$(this).val();n?(n=n.toLowerCase(),$.each(a,function(o,i){let t=i.luoghi_residenza.length;(-1!=i.luoghi_residenza[t-1].regione.toLowerCase().indexOf(n)||-1!=i.luoghi_residenza[t-1].provincia.toLowerCase().indexOf(n)||-1!=i.luoghi_residenza[t-1].comune.toLowerCase().indexOf(n)||i.luoghi_residenza[t-1].anno.toLowerCase().indexOf(n)>-1||-1!=i.luoghi_residenza[t-1].indirizzo.toLowerCase().indexOf(n))&&(r[e]=i,e++)}),m(r)):m(a)}),$(document).on("click",".btnAggiungiResidenza",function(){dt='{"regione":"'+$("#regioneNuovaRes").val().toString()+'","provincia":"'+$("#provinciaNuovaRes").val().toString()+'","comune":"'+$("#comuneNuovaRes").val().toString()+'","indirizzo":"'+$("#indirizzoNuovaRes").val().toString()+'","anno_residenza":"'+$("#dataNuovaRes").val().toString()+'"}',$.ajax({type:"POST",headers:{"Access-Control-Allow-Origin":"*"},data:dt,contentType:"application/json",crossDomain:!0,url:"https://late-frost-5190.getsandbox.com/anagrafiche/add/"+localStorage.getItem("idprova")+"/residenza/",dataType:"json",success:function(e){},error:function(e,n,o){$("#modalNuovaResidenza").modal("toggle"),document.getElementById("loading_screen").style.display="block",v(),a=[],$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche",dataType:"json",success:function(e){$.each(e,function(e,n){a.push(Object.assign({},n))});for(let e=0;e<a.length;e++)a[e].id==localStorage.getItem("idprova")&&(e=(a=a[e]).length);m(a),document.getElementById("loading_screen").style.display="none"}})}})}),$("#shownumber").change(function(){m(a)}),$(document).on("click",".edit",function(){n=$(this).attr("id"),o=localStorage.getItem("idprova"),$("#regione").val(a.luoghi_residenza[n-1].regione),$("#provincia").val(a.luoghi_residenza[n-1].provincia),$("#comune").val(a.luoghi_residenza[n-1].comune),$("#viamod").val(a.luoghi_residenza[n-1].indirizzo),$("#annomod").val(a.luoghi_residenza[n-1].anno)}),$(document).on("click",".inviaModifica",function(){dt='{"regione":"'+$("#regione").val().toString()+'","provincia":"'+$("#provincia").val().toString()+'","comune":"'+$("#comune").val().toString()+'","indirizzo":"'+$("#viamod").val().toString()+'","anno":"'+$("#annomod").val().toString()+'"}',$.ajax({type:"POST",headers:{"Access-Control-Allow-Origin":"*"},data:dt,contentType:"application/json",crossDomain:!0,url:"https://late-frost-5190.getsandbox.com/anagrafiche/edit/"+o+"/residenza/"+n+"/",dataType:"json",success:function(e){}}),$("#exampleModalEdit").modal("toggle"),document.getElementById("loading_screen").style.display="block",v(),a=[],$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche",dataType:"json",success:function(e){$.each(e,function(e,n){a.push(Object.assign({},n))});for(let e=0;e<a.length;e++)a[e].id==localStorage.getItem("idprova")&&(e=(a=a[e]).length);m(a),document.getElementById("loading_screen").style.display="none"}})}),$(document).on("click",".delete",function(){n=$(this).attr("id"),o=localStorage.getItem("idprova")}),$(document).on("click",".btnElimina",function(){$.ajax({type:"DELETE",headers:{"Access-Control-Allow-Origin":"*"},contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche/remove/"+o+"/residenza/"+n+"/",dataType:"json"}).then(function(e){$(".bottoni .delete").each(function(){$(this).attr("id")==n&&$(this).parent().parent().remove()})},function(e,o,i){$(".bottoni .delete").each(function(){$(this).attr("id")==n&&$(this).parent().parent().remove()})})}),$(document).on("click",".order",function(){var e=new Array;switch($(this).attr("id")){case"nome":for(let n=0;n<a.length;n++){for(let o=n+1;o<a.length;o++)l?f(a[o].nome,a[n].nome)>0&&(e=a[o],a[o]=a[n],a[n]=e):f(a[o].nome,a[n].nome)<0&&(e=a[n],a[n]=a[o],a[o]=e);m(a)}l=!l;break;case"cognome":for(let n=0;n<a.length;n++){for(let o=n+1;o<a.length;o++)d?f(a[o].cognome,a[n].cognome)>0&&(e=a[o],a[o]=a[n],a[n]=e):f(a[o].cognome,a[n].cognome)<0&&(e=a[n],a[n]=a[o],a[o]=e);m(a)}d=!d;break;case"regione":for(let i=0;i<a.length;i++){for(let t=i+1;t<a.length;t++){var n=a[t].luoghi_residenza.length,o=a[i].luoghi_residenza.length;s?f(a[t].luoghi_residenza[n-1].regione,a[i].luoghi_residenza[o-1].regione)>0&&(e=a[t],a[t]=a[i],a[i]=e):f(a[t].luoghi_residenza[n-1].regione,a[i].luoghi_residenza[o-1].regione)<0&&(e=a[i],a[i]=a[t],a[t]=e)}m(a)}s=!s;break;case"provincia":for(let i=0;i<a.length;i++){for(let t=i+1;t<a.length;t++){n=a[t].luoghi_residenza.length,o=a[i].luoghi_residenza.length;p?f(a[t].luoghi_residenza[n-1].provincia,a[i].luoghi_residenza[o-1].provincia)>0&&(e=a[t],a[t]=a[i],a[i]=e):f(a[t].luoghi_residenza[n-1].provincia,a[i].luoghi_residenza[o-1].provincia)<0&&(e=a[i],a[i]=a[t],a[t]=e)}m(a)}p=!p;break;case"comune":for(let i=0;i<a.length;i++){for(let t=i+1;t<a.length;t++){n=a[t].luoghi_residenza.length,o=a[i].luoghi_residenza.length;g?f(a[t].luoghi_residenza[n-1].comune,a[i].luoghi_residenza[o-1].comune)>0&&(e=a[t],a[t]=a[i],a[i]=e):f(a[t].luoghi_residenza[n-1].comune,a[i].luoghi_residenza[o-1].comune)<0&&(e=a[i],a[i]=a[t],a[t]=e)}m(a)}g=!g;break;case"anno":for(let n=0;n<a.length;n++){for(let o=n+1;o<a.length;o++)u?f(a[o].anno_nascita,a[n].anno_nascita)>0&&(e=a[o],a[o]=a[n],a[n]=e):f(a[o].anno_nascita,a[n].anno_nascita)<0&&(e=a[n],a[n]=a[o],a[o]=e);m(a)}u=!u}}),$(document).on("click","#previous",function(){1==t&&t++,h(--t,$("#shownumber").val(),a)}),$(document).on("click","#next",function(){t==e&&t--,h(++t,$("#shownumber").val(),a)}),$(document).on("click",".numeri>.page-link",function(){var e=$(this).text();t=e,h(e,$("#shownumber").val(),a)}),i=!1,$(window).scroll(function(){$(this).scrollTop()>100?(i||($("#nav>ul").prepend("<li class='titolo'>Ufficio Anagrafe</li>"),i=!0),$("#nav").addClass("shrink")):(i&&($("#nav>ul").find(":first").remove(),i=!1),$("#nav").removeClass("shrink"))});var z=$(window),y=$("body");breakpoints({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:[null,"736px"]}),z.on("load",function(){window.setTimeout(function(){y.removeClass("is-preload")},100)}),$("#nav > ul").dropotron({mode:"fade",noOpenerFade:!0,alignment:"center"}),$('<div id="titleBar"><a href="#navPanel" class="toggle"></a></div>').appendTo(y),$('<div id="navPanel"><nav>'+$("#nav").navList()+"</nav></div>").appendTo(y).panel({delay:500,hideOnClick:!0,hideOnSwipe:!0,resetScroll:!0,resetForms:!0,side:"left",target:y,visibleClass:"navPanel-visible"})});