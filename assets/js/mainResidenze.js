$(function(){var e,n,o,i,a=1,t=new Array,r=new Array,c=new Array,l=(localStorage.getItem("idprova"),!1),s=!1,d=!1,p=!1,u=!1,m=!1;function g(n){$(".pagination").empty(),e=n.length%$("#shownumber").val()==0?parseInt(n.length/$("#shownumber").val()):parseInt(n.length/$("#shownumber").val()+1),$(".pagination").append('<li class="page-item" id="previous"> <a class="page-link" href="#main" tabindex="-1"  style="text-decoration:none"aria-disabled="true">Precedente</a> </li>');for(let n=0;n<e;n++)$(".pagination").append('<li class="page-item numeri"><a class="page-link" style="text-decoration:none" href="#main">'+(n+1)+"</a></li>");$(".pagination").append('<li class="page-item" id="next"> <a class="page-link" href="#main" style="text-decoration:none"tabindex="-1" aria-disabled="true">Successivo</a> </li>'),v(1,$("#shownumber").val(),n)}function h(){$("#persone").empty()}function v(e,n,o){let i=0;h(),i=o.length<n*e?o.length:n*e;for(let a=e*n-n;a<i;a++){let e=o[a].luoghi_residenza[0].anno.split("-")[2]+"-"+o[a].luoghi_residenza[0].anno.split("-")[1]+"-"+o[a].luoghi_residenza[0].anno.split("-")[0];$("#persone").append("<tr><td>"+o[a].nome+"</td><td>"+o[a].cognome+"</td><td>"+o[a].luoghi_residenza[0].regione+"</td><td>"+o[a].luoghi_residenza[0].provincia+"</td><td>"+o[a].luoghi_residenza[0].comune+"</td><td>"+o[a].luoghi_residenza[0].indirizzo+"</td><td>"+e+'</td><td class="d-flex justify-content-center bottoni"><a href="indexResidenzePersona.html"><i class="fas fa-home home rounded" title=" Residenza" id="'+o[a].id+'"></i></a></td></tr>')}}function f(e,n){let o=0;return e>n?o=1:e<n&&(o=-1),o}$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche",dataType:"json",success:function(e){$.each(e,function(e,n){null==n.data_morte&&t.push(Object.assign({},n))}),g(t),document.getElementById("loading_screen").style.display="none"}}),$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/territorio",dataType:"json",success:function(e){$.each(e,function(e,n){c.push(Object.assign({},n)),c=c[0];for(let e=0;e<20;e++){$(".regioni").append(new Option(c[e].nome,c[e].nome));for(let n=0;n<c[e].province.length;n++){$(".province").append(new Option(c[e].province[n].nome));for(let o=0;o<c[e].province[n].comuni.length;o++)$(".comuni").append(new Option(c[e].province[n].comuni[o])),$("#birthPlace").append(new Option(c[e].province[n].comuni[o]))}}})}}),$(document).on("change",".regioni",function(){$(".province").empty(),$(".comuni").empty(),$(".province").append(new Option("Seleziona provincia")),$(".comuni").append(new Option("Seleziona comune"));for(var e=$(".regioni").val(),n=0;n<20;n++)if(c[n].nome==e)for(let e=0;e<c[n].province.length;e++){$(".province").append(new Option(c[n].province[e].nome,c[n].province[e].nome));for(let o=0;o<c[n].province[e].comuni.length;o++)$(".comuni").append(new Option(c[n].province[e].comuni[o],c[n].province[e].comuni[o]))}}),$(document).on("click"),$(document).on("change",".province",function(){$(".comuni").empty(),$(".comuni").append(new Option("Seleziona comune"));for(var e=$(".province").val(),n=0;n<20;n++)for(var o=0;o<c[n].province.length;o++)if(c[n].province[o].nome==e){$(".regioni").val(c[n].nome);for(var i=0;i<c[n].province[o].comuni.length;i++)$(".comuni").append(new Option(c[n].province[o].comuni[i],c[n].province[o].comuni[i]))}}),$(document).on("change",".comuni",function(){for(var e=$(".comuni").val(),n=0;n<20;n++)for(var o=0;o<c[n].province.length;o++)for(var i=0;i<c[n].province[o].comuni.length;i++)c[n].province[o].comuni[i]==e&&($(".regioni").val(c[n].nome),$(".province").val(c[n].province[o].nome),$(".comuni").val(e))}),$(document).on("click",".home",function(){localStorage.setItem("idprova",$(this).attr("id"))}),$(document).on("keyup","#search",function(){r.length=0,h();var e=0,n=$(this).val();n?(n=n.toLowerCase(),$.each(t,function(o,i){i.luoghi_residenza.length;-1!=i.codice.toLowerCase().indexOf(n)&&(r[e]=i,e++)}),g(r)):g(t)}),$("#shownumber").change(function(){g(t)}),$(document).on("click",".edit",function(){n=$(this).attr("id");for(let o=0;o<t.length;o++)if(t[o].id==n){var e=t[o];break}$("#nomemod").val(e.nome),$("#cognomemod").val(e.cognome);let o=e.luoghi_residenza.length;$("#comunemod").val(e.luoghi_residenza[o-1].comune),$("#provinciamod").val(e.luoghi_residenza[o-1].provincia),$("#regionemod").val(e.luoghi_residenza[o-1].regione),$("#annomod").val(e.anno_nascita),$("#viamod").val(e.luoghi_residenza[o-1].indirizzo)}),$(document).on("click",".inviaModifica",function(){dt='{"regione":"'+$("#regionemod").val().toString()+'","provincia":"'+$("#provinciamod").val().toString()+'","comune":"'+$("#comunemod").val().toString()+'","indirizzo":"'+$("#viamod").val().toString()+'"}',$.ajax({type:"POST",headers:{"Access-Control-Allow-Origin":"*"},data:dt,contentType:"application/json",crossDomain:!0,url:"https://late-frost-5190.getsandbox.com/anagrafiche/edit/"+n+"/residenza/",dataType:"json",success:function(e){}}),dt='{"nome":"'+$("#nomemod").val().toString()+'","cognome":"'+$("#cognomemod").val().toString()+'","anno_nascita":"'+$("#annomod").val().toString()+'","anno_residenza":"2020"}',$.ajax({type:"POST",headers:{"Access-Control-Allow-Origin":"*"},data:dt,contentType:"application/json",crossDomain:!0,url:"https://late-frost-5190.getsandbox.com/anagrafiche/edit/"+n+"/",dataType:"json",success:function(e){}}),$("#exampleModalEdit").modal("toggle"),document.getElementById("loading_screen").style.display="block",h(),t=[],$.ajax({type:"GET",contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche",dataType:"json",success:function(e){$.each(e,function(e,n){t.push(Object.assign({},n)),document.getElementById("loading_screen").style.display="none"}),g(t)}})}),$(document).on("click",".delete",function(){o=$(this).attr("id")}),$(document).on("click",".btnElimina",function(){$.ajax({type:"DELETE",headers:{"Access-Control-Allow-Origin":"*"},contentType:"application/json",url:"https://late-frost-5190.getsandbox.com/anagrafiche/remove/"+o+"/",dataType:"json"}).then(function(e){$(".bottoni .delete").each(function(){$(this).attr("id")==o&&$(this).parent().parent().remove()})},function(e,n,o){alert(e.responseText)})}),$(document).on("click",".decesso",function(){}),$(document).on("click",".order",function(){var e=new Array;switch($(this).attr("id")){case"nome":for(let n=0;n<t.length;n++){for(let o=n+1;o<t.length;o++)l?f(t[o].nome,t[n].nome)>0&&(e=t[o],t[o]=t[n],t[n]=e):f(t[o].nome,t[n].nome)<0&&(e=t[n],t[n]=t[o],t[o]=e);g(t)}l=!l;break;case"cognome":for(let n=0;n<t.length;n++){for(let o=n+1;o<t.length;o++)s?f(t[o].cognome,t[n].cognome)>0&&(e=t[o],t[o]=t[n],t[n]=e):f(t[o].cognome,t[n].cognome)<0&&(e=t[n],t[n]=t[o],t[o]=e);g(t)}s=!s;break;case"regione":for(let i=0;i<t.length;i++){for(let a=i+1;a<t.length;a++){var n=t[a].luoghi_residenza.length,o=t[i].luoghi_residenza.length;d?f(t[a].luoghi_residenza[n-1].regione,t[i].luoghi_residenza[o-1].regione)>0&&(e=t[a],t[a]=t[i],t[i]=e):f(t[a].luoghi_residenza[n-1].regione,t[i].luoghi_residenza[o-1].regione)<0&&(e=t[i],t[i]=t[a],t[a]=e)}g(t)}d=!d;break;case"provincia":for(let i=0;i<t.length;i++){for(let a=i+1;a<t.length;a++){n=t[a].luoghi_residenza.length,o=t[i].luoghi_residenza.length;p?f(t[a].luoghi_residenza[n-1].provincia,t[i].luoghi_residenza[o-1].provincia)>0&&(e=t[a],t[a]=t[i],t[i]=e):f(t[a].luoghi_residenza[n-1].provincia,t[i].luoghi_residenza[o-1].provincia)<0&&(e=t[i],t[i]=t[a],t[a]=e)}g(t)}p=!p;break;case"comune":for(let i=0;i<t.length;i++){for(let a=i+1;a<t.length;a++){n=t[a].luoghi_residenza.length,o=t[i].luoghi_residenza.length;u?f(t[a].luoghi_residenza[n-1].comune,t[i].luoghi_residenza[o-1].comune)>0&&(e=t[a],t[a]=t[i],t[i]=e):f(t[a].luoghi_residenza[n-1].comune,t[i].luoghi_residenza[o-1].comune)<0&&(e=t[i],t[i]=t[a],t[a]=e)}g(t)}u=!u;break;case"anno":for(let n=0;n<t.length;n++){for(let o=n+1;o<t.length;o++)m?f(t[o].anno_nascita,t[n].anno_nascita)>0&&(e=t[o],t[o]=t[n],t[n]=e):f(t[o].anno_nascita,t[n].anno_nascita)<0&&(e=t[n],t[n]=t[o],t[o]=e);g(t)}m=!m}}),$(document).on("click","#previous",function(){1==a&&a++,v(--a,$("#shownumber").val(),t)}),$(document).on("click","#next",function(){a==e&&a--,v(++a,$("#shownumber").val(),t)}),$(document).on("click",".numeri>.page-link",function(){var e=$(this).text();a=e,v(e,$("#shownumber").val(),t)}),i=!1,$(window).scroll(function(){$(this).scrollTop()>100?(i||($("#nav>ul").prepend("<li class='titolo'>Ufficio Anagrafe</li>"),i=!0),$("#nav").addClass("shrink")):(i&&($("#nav>ul").find(":first").remove(),i=!1),$("#nav").removeClass("shrink"))});var z=$(window),y=$("body");breakpoints({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:[null,"736px"]}),z.on("load",function(){window.setTimeout(function(){y.removeClass("is-preload")},100)}),$("#nav > ul").dropotron({mode:"fade",noOpenerFade:!0,alignment:"center"}),$('<div id="titleBar"><a href="#navPanel" class="toggle"></a></div>').appendTo(y),$('<div id="navPanel"><nav>'+$("#nav").navList()+"</nav></div>").appendTo(y).panel({delay:500,hideOnClick:!0,hideOnSwipe:!0,resetScroll:!0,resetForms:!0,side:"left",target:y,visibleClass:"navPanel-visible"})});